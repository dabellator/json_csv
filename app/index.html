<html>
<head>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
  <!-- OR -->
  <script src="http://ajax.googleapis.com/ajax/libs/mootools/1.4.5/mootools-yui-compressed.js"></script>
  <!-- OR NONE IF YOU ARE USING PURE JAVASCRIPT -->
</head>
<body>
<input style="color:blue;" id="jsonFolder" type="file" multiple nwdirectory/>
<input style="color:green;" id="csvFolder" type="file" nwsaveas nwdirectory />

<script type="text/javascript">
  var fs = require('fs');
  var gui = require('nw.gui');
  var json2csv = require('json2csv');
  var converter = require('json-2-csv');

  var $jsonFolder = $("#jsonFolder");
  console.log($jsonFolder);

  var jsonFiles;
  var jsonData = [];
  var resultNumber = 10;
  var readPath = '/Projects/json_csv/example_json/';
  var currentJSON;
  var writePath = '/Projects/json_csv/example_csv/';

  fs.realpath('./app', function(err, resolvedPath) {
    if (err) throw err;
    console.log(resolvedPath); //returns full file path
  });

  var readDirCallback = function (err, files) {
    if (err) throw err;
    jsonFiles = files;
    jsonFiles.forEach(readConvertWrite);
  };

  function readConvertWrite(element, index, array) {
    jsonData = JSON.parse(fs.readFileSync(process.env.HOME + readPath + element, 'utf8')).Response.Result;

    converter.json2csv(jsonData, function(err, csv) {
      if (err) throw err;
      fs.writeFileSync(process.env.HOME + writePath + index + '.csv', csv);
    });

  };

  fs.readdir(process.env.HOME + readPath, readDirCallback);

</script>

</body>
</html>
